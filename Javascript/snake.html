<html>
<head>
<style>
body {
	margin: 0 0 0 0;
}
.quadro {
	background-color: #FF0000;
	position: absolute;
}
</style>
</head>
<body onkeydown="getKeyCod()">
	
		<div id="snake" style="visibility:hidden">
			<div id="quadro" class="quadro"></div>
			<div id="quadro2" class="quadro"></div>
			<div id="quadro3" class="quadro"></div>
		</div>
		<button id="start" onclick="visibility()">Start</button>
<script>
const mov = 20;

let quadro = document.getElementsByClassName("quadro");
console.log(quadro);
//let random = Math.floor(Math.random() *  document.body.style.height);

//JSON JavaScript Object Notation
let props = {
			  width: 20,
			  height: 20
			}
			
let dir = "right";
let snakeWidth = 0;

function changeProps() {
	let distance = 0;
	for(let i=quadro.length-1; i>=0; i--){
		quadro[i].style.width = props.width + "px";
		quadro[i].style.height = props.height + "px";
		quadro[i].style.left = distance + "px";
		quadro[i].distance = distance;
		snakeWidth += props.width;
		distance += 20;
	}
	snake.style.width = snakeWidth;
	snake.style.height = props.height;
}

changeProps(quadro);

let leftDistance = 1;
let topDistance = 1;

function move(){
	let qPreTop = new Array();
	let qPreLeft = new Array();
	
	//movimento verso destra
	if(dir === "right"){		
		//fino a quando arriva in fondo allo schermo
		if(quadro[0].offsetLeft < window.innerWidth - props.width){
			leftDistance += mov;
			//sposto il primo quadrato verso destra tutti gli altri seguono quello precedente
			qPreTop[0] = quadro[0].style.top;
			qPreLeft[0] = quadro[0].style.left;
			quadro[0].style.left = leftDistance + "px";
		//se tocca il bordo dello schermo stop, perdi
		}else{
			 clearInterval(loop);
			 alert("You lost!");
		}
	}
	
	//movimento verso il basso
	if(dir === "down"){
		if(quadro[0].offsetTop < window.innerHeight - props.width){
			topDistance += mov;
			//sposto il primo quadrato verso il basso tutti gli altri seguono quello precedente
			qPreTop[0] = quadro[0].style.top;
			qPreLeft[0] = quadro[0].style.left;
			quadro[0].style.top = topDistance + "px";
		}else{
			 clearInterval(loop);
			 alert("You lost!");
		}
	}
	
	//movimento verso sinistra
	if(dir === "left"){
		if(quadro[0].offsetLeft > snakeWidth){
			leftDistance -= mov;
			//sposto il primo quadrato verso sinistra tutti gli altri seguono quello precedente
			qPreTop[0] = quadro[0].style.top;
			qPreLeft[0] = quadro[0].style.left;
			quadro[0].style.left = leftDistance + "px";
		}else{
			 clearInterval(loop);
			 alert("You lost!");
		}
	}
	
		//ogni quadrato prende la posizione del quadrato che lo precede	
	for(let i=1; i<quadro.length; i++){
		qPreTop[i] = quadro[i].style.top;
		qPreLeft[i] =quadro[i].style.left;
		quadro[i].style.top = qPreTop[i-1];
		quadro[i].style.left = qPreLeft[i-1];
	}
		
}

let loop;

function visibility(){
	/*for(let i=0; i<quadro.length; i++){
		quadro[i].style.visibility = "visible";
	}*/
	snake.style.visibility = "visible";
	document.getElementById("start").style.visibility = "hidden";
	
	loop = setInterval(move,200);
}


//TO DO: controlli non posso cliccare giu e poi su e viceversa o dx e sx e vice
function getKeyCod() {
	let key = window.event.keyCode;
	console.log('key :', key);

	//destra
	if (key == 39) {
		if(dir !== "right"){
			dir = "right";
		}
	//sinistra
	} else if (key == 37) {
		if(dir !== "left"){
			dir = "left";				
		}
	//su
	} else if (key == 38) {
		if(dir !== "up"){
			dir = "up";			
		}
	//giÃ¹
	} else if (key == 40) {
		if(dir !== "down"){
			dir = "down";	
		}
	}
}

</script>

</body>
</html>
